<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NDE News Dashboard</title>
<link rel="icon" type="image/png" href="https://i.ibb.co/4ZGZhK8G/breaking-4.png">
<style>
:root {--bg:#0e0e0e;--card:#141414;--accent:#00aaff;--muted:#9aa;--text:#e9eef6;}
body {margin:0;background:var(--bg);color:var(--text);font-family:"Inter","Segoe UI",Arial,sans-serif;}
.wrap {max-width:1200px;margin:18px auto;padding:18px;}
header {display:flex;align-items:center;gap:16px;flex-wrap:wrap;}
header img{height:50px;}
h1{margin:0;font-size:22px;color:var(--accent);}
.card{background:var(--card);border-radius:12px;padding:16px;margin-top:12px;box-shadow:0 6px 28px rgba(0,0,0,0.6);}
.row{display:flex;gap:12px;align-items:flex-start;}
.col{display:flex;flex-direction:column;gap:8px;}
label{font-size:13px;color:var(--muted);}
select,input,textarea,button{padding:8px 10px;border-radius:8px;background:#0f1720;border:1px solid #222;color:var(--text);font-size:14px;}
button{cursor:pointer;border:none;transition:.2s;}
button:hover{opacity:.85;}
.left{flex:1;}
.right{min-width:300px;}
table{width:100%;border-collapse:collapse;margin-top:8px;}
th,td{padding:8px;border:1px solid #222;font-size:13px;}
th{background:#111;}
.tiny{font-size:12px;color:var(--muted);}
.hidden{display:none;}
.center{text-align:center;}
.smallbtn{padding:6px 10px;border-radius:6px;background:#0b1220;color:var(--text);}
@media(max-width:880px){.row{flex-direction:column;}.right{min-width:unset;width:100%;}}
.today{background:#ffaa00;color:#000;font-weight:700;}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <img src="https://i.ibb.co/4ZGZhK8G/breaking-4.png" alt="Logo">
    <h1>NDE News Dashboard</h1>
  </header>

  <!-- LOGIN CARD -->
  <div id="loginCard" class="card">
    <div class="row">
      <div class="col">
        <label>Username</label>
        <select id="userSelect"></select>
      </div>
      <div class="col">
        <label>Password</label>
        <input id="pwInput" type="password" placeholder="Enter password" />
      </div>
      <div class="col">
        <label>&nbsp;</label>
        <button id="loginBtn" style="background:var(--accent);color:#001;font-weight:600;">Login</button>
      </div>
      <div style="margin-left:auto" class="muted tiny" id="loginStatus">Select user → login</div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dash" class="card hidden">
    <div class="row">
      <div class="left col">
        <div id="greeting" class="accent" style="font-size:16px"></div>
        <div class="tiny muted" id="roleBadge"></div>
        <div class="tiny muted">Today: <span id="todayName"></span></div>
        <div class="tiny muted">Time: <span id="nowTime"></span></div>

        <hr style="border:none;border-top:1px solid #222;margin:10px 0" />
        <div>
          <b>Today's Tasks</b>
          <div id="todayTasksArea" style="margin-top:8px"></div>
        </div>
        <div style="margin-top:12px">
          <b>Quick Tools</b>
          <div class="controls" style="margin-top:8px">
            <button id="logoutBtn" class="smallbtn">Log out</button>
          </div>
        </div>
      </div>

      <div class="right col">
        <div id="userMgmt" class="hidden">
          <b>User Management (Logan P)</b>
          <div style="margin-top:8px">
            <select id="allUsers"></select>
            <input id="newRole" placeholder="New Role"/>
            <button id="editRoleBtn" class="smallbtn">Change Role</button>
            <button id="removeUserBtn" class="smallbtn">Remove User</button>
          </div>
          <div style="margin-top:6px">
            <input id="addUserName" placeholder="New Username"/>
            <input id="addUserRole" placeholder="Role"/>
            <button id="addUserBtn" class="smallbtn">Add User</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule Table -->
    <div class="card" style="margin-top:12px">
      <b>Full Weekly Schedule</b>
      <table id="scheduleTable">
        <thead>
          <tr><th>User</th><th>Role</th><th>Monday</th><th>Tuesday</th><th>Wednesday</th><th>Thursday</th><th>Friday</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

</div>

<script>
function el(id){return document.getElementById(id);}
function pad(n){return n<10?'0'+n:n;}
function nowISODate(){return new Date().toISOString().slice(0,10);}
function timeNowStr(){const d=new Date();return pad(d.getHours())+':'+pad(d.getMinutes());}

// ---------- Users ----------
const STORAGE_KEY='nde_news_offline_v11';
let defaultUsers = {
"Luca P":{passwordPlain:'Luca123',role:'Anchor',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Ivana R":{passwordPlain:'Ivana123',role:'Head Writer',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Matthew F":{passwordPlain:'Matthew123',role:'Reporter',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Logan P":{passwordPlain:'Lp1157551',role:'Head of News/Director',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Lunch Recess',Friday:'Library Meeting -- Last Recess'},notes:'',eventsNotes:{}},
"Maddie S":{passwordPlain:'Maddie123',role:'Manager',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Athan T":{passwordPlain:'Athan123',role:'Anchor',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Lily S":{passwordPlain:'Lily123',role:'Anchor',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"George H":{passwordPlain:'George123',role:'Reporter',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Elena C":{passwordPlain:'Elena123',role:'Assistant Director Shadow – Emma R',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Juliana T":{passwordPlain:'Juliana123',role:'Assistant Director Shadow – Emma R',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
"Emma R":{passwordPlain:'Emma123',role:'Assistant Director',schedule:{Monday:'Meeting Library -- Lunch Recess',Tuesday:'Mrs Garafalo Duty -- Lunch Recess',Wednesday:'Junior Members -- First Recess',Thursday:'Library Meeting -- Last Recess',Friday:'Library Meeting -- Lunch Recess'},notes:'',eventsNotes:{}},
//... Add all other users similarly
};

// ---------- Load / Init ----------
let store=null;
let currentUser=null;
function loadStore(){
  const raw=localStorage.getItem(STORAGE_KEY);
  let tempStore=null;
  if(raw) try{tempStore=JSON.parse(raw);}catch(e){}
  store={users:{}};
  for(const name in defaultUsers){
    const u=defaultUsers[name];
    let pass=u.passwordPlain;
    if(tempStore && tempStore.users && tempStore.users[name] && tempStore.users[name].passwordPlain)
      pass=tempStore.users[name].passwordPlain;
    store.users[name]={passwordPlain:pass,role:u.role,schedule:u.schedule,notes:u.notes,eventsNotes:u.eventsNotes};
  }
  localStorage.setItem(STORAGE_KEY,JSON.stringify(store));
}

// Populate user dropdown
const userSelect=el('userSelect');
function populateUserDropdown(){
  userSelect.innerHTML='<option value="">-- Choose User --</option>';
  for(const name in store.users){
    const o=document.createElement('option');
    o.value=name; o.text=name;
    userSelect.appendChild(o);
  }
}

// ---------- Login ----------
const pwInput=el('pwInput'), loginBtn=el('loginBtn'), loginStatus=el('loginStatus');
const dash=el('dash'), loginCard=el('loginCard');
loginBtn.addEventListener('click',()=>{
  const user=userSelect.value, pw=pwInput.value;
  if(!user){loginStatus.textContent='Choose a user'; return;}
  const u=store.users[user];
  if(u.passwordPlain === pw){
    currentUser=user;
    loginCard.classList.add('hidden');
    dash.classList.remove('hidden');
    pwInput.value='';
    loginStatus.textContent='Logged in';
    updateDisplays();
    if(currentUser==='Logan P') el('userMgmt').classList.remove('hidden');
  } else loginStatus.textContent='Incorrect password';
});

// Logout
el('logoutBtn').addEventListener('click',()=>{
  dash.classList.add('hidden');
  loginCard.classList.remove('hidden');
  currentUser=null;
  loginStatus.textContent='Select user → login';
});

// ---------- Display ----------
const greeting=el('greeting'), roleBadge=el('roleBadge'), todayName=el('todayName'),
nowTimeEl=el('nowTime'), todayTasksArea=el('todayTasksArea'), scheduleBody=el('scheduleTable').querySelector('tbody');

function updateDisplays(){
  if(!currentUser) return;
  const u=store.users[currentUser];
  greeting.textContent='Hello, '+currentUser+'!';
  roleBadge.textContent=u.role;
  const d=new Date(), dow=d.toLocaleString('en-US',{weekday:'long'});
  todayName.textContent=dow+', '+nowISODate();
  nowTimeEl.textContent=timeNowStr();
  todayTasksArea.textContent=u.schedule[dow]||'No tasks today';
  renderScheduleTable();
}

// ---------- Render schedule table ----------
function renderScheduleTable(){
  scheduleBody.innerHTML='';
  for(const name in store.users){
    const u=store.users[name];
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${name}</td><td>${u.role}</td>
    <td>${u.schedule.Monday||''}</td>
    <td>${u.schedule.Tuesday||''}</td>
    <td>${u.schedule.Wednesday||''}</td>
    <td>${u.schedule.Thursday||''}</td>
    <td>${u.schedule.Friday||''}</td>`;
    scheduleBody.appendChild(tr);
  }
}

// ---------- Init ----------
loadStore();
populateUserDropdown();
</script>
</body>
</html>
